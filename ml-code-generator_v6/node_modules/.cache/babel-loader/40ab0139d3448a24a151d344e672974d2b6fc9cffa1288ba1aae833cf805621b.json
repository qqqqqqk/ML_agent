{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.WT = void 0;\nconst transport_js_1 = require(\"../transport.js\");\nconst globals_node_js_1 = require(\"../globals.node.js\");\nconst engine_io_parser_1 = require(\"engine.io-parser\");\nconst debug_1 = __importDefault(require(\"debug\")); // debug()\nconst debug = (0, debug_1.default)(\"engine.io-client:webtransport\"); // debug()\n/**\n * WebTransport transport based on the built-in `WebTransport` object.\n *\n * Usage: browser, Node.js (with the `@fails-components/webtransport` package)\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebTransport\n * @see https://caniuse.com/webtransport\n */\nclass WT extends transport_js_1.Transport {\n  get name() {\n    return \"webtransport\";\n  }\n  doOpen() {\n    try {\n      // @ts-ignore\n      this._transport = new WebTransport(this.createUri(\"https\"), this.opts.transportOptions[this.name]);\n    } catch (err) {\n      return this.emitReserved(\"error\", err);\n    }\n    this._transport.closed.then(() => {\n      debug(\"transport closed gracefully\");\n      this.onClose();\n    }).catch(err => {\n      debug(\"transport closed due to %s\", err);\n      this.onError(\"webtransport error\", err);\n    });\n    // note: we could have used async/await, but that would require some additional polyfills\n    this._transport.ready.then(() => {\n      this._transport.createBidirectionalStream().then(stream => {\n        const decoderStream = (0, engine_io_parser_1.createPacketDecoderStream)(Number.MAX_SAFE_INTEGER, this.socket.binaryType);\n        const reader = stream.readable.pipeThrough(decoderStream).getReader();\n        const encoderStream = (0, engine_io_parser_1.createPacketEncoderStream)();\n        encoderStream.readable.pipeTo(stream.writable);\n        this._writer = encoderStream.writable.getWriter();\n        const read = () => {\n          reader.read().then(({\n            done,\n            value\n          }) => {\n            if (done) {\n              debug(\"session is closed\");\n              return;\n            }\n            debug(\"received chunk: %o\", value);\n            this.onPacket(value);\n            read();\n          }).catch(err => {\n            debug(\"an error occurred while reading: %s\", err);\n          });\n        };\n        read();\n        const packet = {\n          type: \"open\"\n        };\n        if (this.query.sid) {\n          packet.data = `{\"sid\":\"${this.query.sid}\"}`;\n        }\n        this._writer.write(packet).then(() => this.onOpen());\n      });\n    });\n  }\n  write(packets) {\n    this.writable = false;\n    for (let i = 0; i < packets.length; i++) {\n      const packet = packets[i];\n      const lastPacket = i === packets.length - 1;\n      this._writer.write(packet).then(() => {\n        if (lastPacket) {\n          (0, globals_node_js_1.nextTick)(() => {\n            this.writable = true;\n            this.emitReserved(\"drain\");\n          }, this.setTimeoutFn);\n        }\n      });\n    }\n  }\n  doClose() {\n    var _a;\n    (_a = this._transport) === null || _a === void 0 ? void 0 : _a.close();\n  }\n}\nexports.WT = WT;","map":{"version":3,"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","WT","transport_js_1","require","globals_node_js_1","engine_io_parser_1","debug_1","debug","default","Transport","name","doOpen","_transport","WebTransport","createUri","opts","transportOptions","err","emitReserved","closed","then","onClose","catch","onError","ready","createBidirectionalStream","stream","decoderStream","createPacketDecoderStream","Number","MAX_SAFE_INTEGER","socket","binaryType","reader","readable","pipeThrough","getReader","encoderStream","createPacketEncoderStream","pipeTo","writable","_writer","getWriter","read","done","onPacket","packet","type","query","sid","data","write","onOpen","packets","i","length","lastPacket","nextTick","setTimeoutFn","doClose","_a","close"],"sources":["d:/University/Group/ml-code-generator_v5/ml-code-generator_v5/node_modules/engine.io-client/build/cjs/transports/webtransport.js"],"sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WT = void 0;\nconst transport_js_1 = require(\"../transport.js\");\nconst globals_node_js_1 = require(\"../globals.node.js\");\nconst engine_io_parser_1 = require(\"engine.io-parser\");\nconst debug_1 = __importDefault(require(\"debug\")); // debug()\nconst debug = (0, debug_1.default)(\"engine.io-client:webtransport\"); // debug()\n/**\n * WebTransport transport based on the built-in `WebTransport` object.\n *\n * Usage: browser, Node.js (with the `@fails-components/webtransport` package)\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebTransport\n * @see https://caniuse.com/webtransport\n */\nclass WT extends transport_js_1.Transport {\n    get name() {\n        return \"webtransport\";\n    }\n    doOpen() {\n        try {\n            // @ts-ignore\n            this._transport = new WebTransport(this.createUri(\"https\"), this.opts.transportOptions[this.name]);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this._transport.closed\n            .then(() => {\n            debug(\"transport closed gracefully\");\n            this.onClose();\n        })\n            .catch((err) => {\n            debug(\"transport closed due to %s\", err);\n            this.onError(\"webtransport error\", err);\n        });\n        // note: we could have used async/await, but that would require some additional polyfills\n        this._transport.ready.then(() => {\n            this._transport.createBidirectionalStream().then((stream) => {\n                const decoderStream = (0, engine_io_parser_1.createPacketDecoderStream)(Number.MAX_SAFE_INTEGER, this.socket.binaryType);\n                const reader = stream.readable.pipeThrough(decoderStream).getReader();\n                const encoderStream = (0, engine_io_parser_1.createPacketEncoderStream)();\n                encoderStream.readable.pipeTo(stream.writable);\n                this._writer = encoderStream.writable.getWriter();\n                const read = () => {\n                    reader\n                        .read()\n                        .then(({ done, value }) => {\n                        if (done) {\n                            debug(\"session is closed\");\n                            return;\n                        }\n                        debug(\"received chunk: %o\", value);\n                        this.onPacket(value);\n                        read();\n                    })\n                        .catch((err) => {\n                        debug(\"an error occurred while reading: %s\", err);\n                    });\n                };\n                read();\n                const packet = { type: \"open\" };\n                if (this.query.sid) {\n                    packet.data = `{\"sid\":\"${this.query.sid}\"}`;\n                }\n                this._writer.write(packet).then(() => this.onOpen());\n            });\n        });\n    }\n    write(packets) {\n        this.writable = false;\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            this._writer.write(packet).then(() => {\n                if (lastPacket) {\n                    (0, globals_node_js_1.nextTick)(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        var _a;\n        (_a = this._transport) === null || _a === void 0 ? void 0 : _a.close();\n    }\n}\nexports.WT = WT;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}